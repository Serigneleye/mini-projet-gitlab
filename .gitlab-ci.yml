stages:
  - Lint
  - Compile
  - Security_scan
  - Test
  - Quality
  - Package
  - Review
  - Staging
  - Production
  - Deployment_validation



flake8:
  image: docker:latest
  stage: Lint
  services:
    - docker:dind
  script:
    - apk add --no-cache python3 py3-pip
    - pip install flake8
    - flake8 --ignore=E501,E303 .

docker_linter:
  image: docker:latest
  stage: Lint
  services:
    - docker:dind
  script:
    - apk add --no-cache hadolint
    - hadolint Dockerfile

compile:
  image: docker:latest
  stage: Compile
  services:
    - docker:dind
  script:
    - docker build -t gitlabProjet .
  artifacts:
    paths:
      - docker_image.tar

test:
  stage: Test
  image: docker:latest
  services:
    - docker:dind
  script:
    # Exécuter le fichier test.py à l'intérieur de l'image
    - docker run --rm gitlaProjet python test.py